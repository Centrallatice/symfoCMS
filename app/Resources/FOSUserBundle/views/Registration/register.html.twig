{% extends '::base.html.twig' %}
{% trans_default_domain 'FOSUserBundle' %}
{% block bodyclass %}hold-transition{% endblock %}

{% block title %}Ajout d'un nouvel utilisateur{% endblock %}
{% block body %}
    <div class="row">
    <div class=" col s12 ">
        <div class="box box-success">
            <div class="box-header with-border">
                <a role="button" class="btn btn-danger pull-right" href="{{ path('ListesUtilisateurs')}}"><i class="fa fa-arrow-circle-left"></i> Annuler</a>
            </div>
            <div class="box-body">
                {% if (success is defined and success == false) %}
                    <div class="alert alert-danger">
                        Des erreurs sont survenues : 
                        <ul>
                        {% for err in details %}
                            <li>{{err.message}}</li>
                        {% endfor %}
                        </ul>
                    </div>
                {% endif %}
                
                {% if (success is not defined or success == false) %}
                    {{ form_start(form, {'method': 'post', 'action': path('user_registration_register'), 'attr': {'class': 'fos_user_registration_register form-horizontal'}}) }}
                    <div class="form-group">
                        {{ form_label(form.codeProfil, "Code du Profil", {'label_attr': {'class': 'col-sm-3 control-label'}}) }}
                        <div class="col-sm-9">
                            {{ form_widget(form.codeProfil, {'attr': {'class': 'form-control','required':'required'}}) }}
                        </div>
                    </div>
                    <div class="form-group">
                        {{ form_label(form.username, "Login", {'label_attr': {'class': 'col-sm-3 control-label'}}) }}
                        <div class="col-sm-9">
                            {{ form_widget(form.username, {'attr': {'class': 'form-control'}}) }}
                        </div>
                    </div>
                    <div class="form-group">
                        {{ form_label(form.plainPassword.first, "Mot de passe", {'label_attr': {'class': 'col-sm-3 control-label'}}) }}
                        <div class="col-sm-9">
                            {{ form_widget(form.plainPassword.first, {'attr': {'class': 'form-control'}}) }}
                        </div>
                    </div>
                    <div class="form-group">
                        {{ form_label(form.plainPassword.second, "Confirmer", {'label_attr': {'class': 'col-sm-3 control-label'}}) }}
                        <div class="col-sm-9">
                            {{ form_widget(form.plainPassword.second, {'attr': {'class': 'form-control'}}) }}
                        </div>
                    </div>
                    <div class="form-group">
                        {{ form_label(form.email, "Email", {'label_attr': {'class': 'col-sm-3 control-label'}}) }}
                        <div class="col-sm-9">
                            {{ form_widget(form.email, {'attr': {'class': 'form-control','required':null}}) }}
                        </div>
                    </div>
                    <div class="form-group">
                        {{ form_label(form.groups, "Type du profil", {'label_attr': {'class': 'col-sm-3 control-label'}}) }}
                        <div class="col-sm-9">
                            {{ form_widget(form.groups, {'attr': {'required':'required'}}) }}
                        </div>
                    </div>
                    <div class="form-group">
                        {{ form_label(form.nom, "Nom", {'label_attr': {'class': 'col-sm-3 control-label'}}) }}
                        <div class="col-sm-9">
                            {{ form_widget(form.nom, {'attr': {'class': 'form-control'}}) }}
                        </div>
                    </div>
                    <div class="form-group">
                        {{ form_label(form.prenom, "Prénom", {'label_attr': {'class': 'col-sm-3 control-label'}}) }}
                        <div class="col-sm-9">
                            {{ form_widget(form.prenom, {'attr': {'class': 'form-control'}}) }}
                        </div>
                    </div>
                    <div class="form-group">
                        {{ form_label(form.Prestataire, "Prestataire", {'label_attr': {'class': 'col-sm-3 control-label'}}) }}
                        <div class="col-sm-9">
                            {{ form_widget(form.Prestataire, {'attr': {'class': 'form-control'}}) }}
                        </div>
                    </div>
                    {{ form_rest(form) }} 
                    <div class="text-center">
                        <button type="submit" class="btn green"/>{{ 'registration.submit'|trans }}</button>
                    </div>
                    {{ form_end(form) }}
                {% else %}
                    {% if (success is defined and success==true) %}
                        <div class="alert alert-success">
                            L'utilisateur a bien été ajouté
                        </div>
                    {% endif %}
                {% endif %}
            </div>
        </div>
    </div>
    </div>
{% endblock %}
{% block javascripts %}
    {{ parent() }}
    <script>
        $(function () {
          $('input').iCheck({
            checkboxClass: 'icheckbox_square-blue',
            radioClass: 'iradio_square-blue',
            increaseArea: '20%' // optional
          });
        });
    </script>
{% endblock javascripts %}